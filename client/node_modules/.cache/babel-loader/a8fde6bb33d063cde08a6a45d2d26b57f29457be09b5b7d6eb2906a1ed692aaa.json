{"ast":null,"code":"import React,{useContext,useEffect}from'react';import{Box,Divider,List,ListItem,MenuItem,Paper,Select,Stack,Typography}from\"@mui/material\";import{UserContext}from\"../UserContext\";import{LayoutContext}from\"../LayoutContext\";import{LoadingPage}from\"../LoadingPage\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export function Orders(){const settings=useContext(UserContext);const layout=useContext(LayoutContext);const[orderData,setOrderData]=React.useState([]);const[dataType]=React.useState(settings.role===\"Mitarbeiter\"?0:1);const[offerData,setOfferData]=React.useState([]);const[isLoading,setIsLoading]=React.useState(false);useEffect(()=>{setIsLoading(true);fetchOrderData();},[]);function fetchOrderData(){fetch('/api/get_order_data',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({user_id:settings.userID,type:dataType})}).then(res=>res.json()).then(res=>{setOrderData(res.content);}).then(()=>{if(dataType===0||dataType===1){fetch('/api/shop',{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({language:settings.language})}).then(res=>res.json()).then(res=>{setOfferData(res.content);setIsLoading(false);});}});}const findSpecificRewardById=id=>{for(const category of offerData){const reward=category.rewards.find(reward=>reward.id===id);if(reward){return reward;}}return null;// Return null if no match is found\n};return isLoading?/*#__PURE__*/_jsx(LoadingPage,{}):/*#__PURE__*/_jsxs(Box,{className:\"Courses\",sx:{height:window.innerHeight-layout.headerAppBarHeight-layout.navigationBarHeight,paddingTop:\"\".concat(layout.headerAppBarHeight,\"px\")},children:[/*#__PURE__*/_jsx(Stack,{direction:\"row\",\"align-content\":\"space-between\",padding:2,children:/*#__PURE__*/_jsx(\"h1\",{children:\"Orders\"})}),/*#__PURE__*/_jsx(List,{children:orderData.map((item,index)=>/*#__PURE__*/_jsx(ListItem,{children:/*#__PURE__*/_jsx(OrderContainer,{orderData:item,fetchOrderData:fetchOrderData,findSpecificRewardById:findSpecificRewardById})},index))})]});}function OrderContainer(_ref){let{orderData,fetchOrderData,findSpecificRewardById}=_ref;const settings=React.useContext(UserContext);const[orderStatus,setOrderStatus]=React.useState(orderData.status);const[offerData]=React.useState(findSpecificRewardById(orderData.order_id));function handleOrderChange(event){console.log(event.target);setOrderStatus(event.target.value);fetch(\"/api/orders/change_status\",{method:'POST',headers:{'Content-Type':'application/json','Accept':'application/json'},body:JSON.stringify({user_id:orderData.user_id,order_id:orderData.order_id,buy_date:orderData.buy_date,status:event.target.value})}).then(res=>res.json()).then(res=>{if(res.type===\"success\"){orderData.status=orderStatus;fetchOrderData();}});}return/*#__PURE__*/_jsx(Paper,{elevation:1,sx:{flexGrow:1},children:/*#__PURE__*/_jsxs(Stack,{direction:\"column\",spacing:1,sx:{flexGrow:1,padding:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",children:offerData.label}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:2,children:[/*#__PURE__*/_jsx(\"img\",{height:\"80px\",style:{aspectRatio:\"auto\"},src:offerData.image,alt:offerData.label}),/*#__PURE__*/_jsxs(Stack,{direction:\"column\",spacing:0,sx:{flexGrow:1,padding:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"div\",textAlign:\"right\",children:offerData.value}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",component:\"div\",textAlign:\"right\",children:orderData.name})]})]}),/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Stack,{direction:\"row\",spacing:2,justifyContent:\"space-between\",paddingRight:2,paddingLeft:2,children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",component:\"div\",children:orderData.buy_date}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",component:\"div\",children:orderStatus})]}),(settings.role===\"Admin\"||settings.role===\"Gesch√§ftsleitung\")&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Divider,{}),/*#__PURE__*/_jsxs(Stack,{direction:\"row\",justifyContent:\"space-between\",children:[/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",component:\"div\",children:\"Change Order Status\"}),/*#__PURE__*/_jsxs(Select,{variant:\"filled\",value:orderStatus,onChange:handleOrderChange,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"WAITING_FOR_DELIVERY\",children:\"WAITING_FOR_DELIVERY\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"COMPLETED\",children:\"COMPLETED\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"DELAYED\",children:\"DELAYED\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"DISCARDED\",children:\"DISCARDED\"})]})]})]})]})});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}