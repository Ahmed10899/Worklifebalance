{"ast":null,"code":"import React,{useContext,useEffect,useLayoutEffect}from'react';import{Box,Paper}from\"@mui/material\";import{CourseViewerNavigation}from\"./CourseViewerNavigation\";import{UserContext}from\"../UserContext\";import{LayoutContext}from\"../LayoutContext\";import{LoadingPage}from\"../LoadingPage\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export function CourseViewer(_ref){let{course}=_ref;const settings=useContext(UserContext);const layout=useContext(LayoutContext);const backend_port=\"80\";const dynamic_backend_url=\"\".concat(window.location.protocol,\"//\").concat(window.location.hostname,\":\").concat(backend_port,\"/static/course_data/\")+\"\".concat(course.id,\"/\").concat(course.language,\"/\").concat(settings.currentCourse.page,\".html\");const[navHeight,setNavHeight]=React.useState(0);const[isLoading,setIsLoading]=React.useState(false);const[iframeHeight,setIframeHeight]=React.useState(window.innerHeight);const updateIframeHeight=()=>{const newHeight=window.innerHeight;setIframeHeight(newHeight);};async function handlePageChange(event,value){setIsLoading(true);settings.setCurrentCourse(prev=>({course:prev.course,page:value}));}useEffect(()=>{window.addEventListener(\"resize\",updateIframeHeight);fetch(\"api/courses/update_state\",{method:\"POST\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify({course_id:course.id,page:settings.currentCourse.page,user_id:settings.userID})}).then(res=>{});setIsLoading(false);return()=>{window.removeEventListener(\"resize\",updateIframeHeight);};},[course.id,settings.currentCourse.page,settings.userID]);useLayoutEffect(()=>{if(!viewerNavRef)setNavHeight(0);else setNavHeight(viewerNavRef.current.getBoundingClientRect().height);},[]);const viewerNavRef=React.useRef(null);return/*#__PURE__*/_jsxs(Box,{className:\"CourseViewer\",children:[/*#__PURE__*/_jsx(CourseViewerNavigation,{count_pages:course.length,current_page:settings.currentCourse.page,onChangePage:handlePageChange,course:course,innerRef:viewerNavRef}),isLoading?/*#__PURE__*/_jsx(LoadingPage,{}):/*#__PURE__*/_jsx(Paper,{elevation:0,className:\"CourseFrame\",sx:{flexGrow:1,position:'absolute',top:\"\".concat(layout.headerAppBarHeight,\"px\"),left:0,right:0},children:/*#__PURE__*/_jsx(\"iframe\",{src:dynamic_backend_url,title:dynamic_backend_url,style:{width:window.innerWidth,height:iframeHeight-layout.navigationBarHeight-navHeight,border:\"none\",paddingBottom:\"\".concat(navHeight,\"px\"),borderBottom:\"thin\",zIndex:-1}})})]});}","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}